import os
import shutil

import numpy as np
from Code.Preprocessing.Project_B import Config

mae_dias_final_list = np.array([('3990324', 26.69546187498539), ('3994483', 8.420393539412084), ('3974901', 11.555247124969952),
                       ('3910837', 8.767377642051084), ('3970494', 6.407229588384128), ('3981733', 8.421874341112863),
                       ('3950660', 9.579838023370582), ('3946200', 9.154422775045292), ('3954524', 10.035978768151509),
                       ('3935563', 6.846575307498029), ('3906864', 7.475936230526027), ('3902729', 6.821817006816487),
                       ('3957783', 14.615653693599445), ('3960685', 5.888020924683935), ('3983328', 7.691005215908316),
                       ('3964898', 12.498411540615834), ('3926797', 11.8691537294395), ('3941267', 7.286214663626673),
                       ('3967454', 6.351571427364812), ('3979586', 8.212604816142537), ('3911428', 13.73205674504099),
                       ('3952492', 13.475463644933754), ('3909677', 17.22251256982116), ('3939481', 10.598983527506888),
                       ('3950441', 12.155093415394486), ('3999053', 12.358722439544945),
                       ('3986511', 11.982592635138147), ('3977577', 7.445174269074745), ('3964440', 12.907887988863726),
                       ('3944344', 8.65742261746638), ('3924240', 16.172310198638936), ('3933328', 10.602153572345506),
                       ('3902894', 9.67300748363902), ('3956739', 15.467809475259292), ('3983584', 5.555384554567561),
                       ('3977192', 8.888389081418747), ('3960109', 27.311260202292342), ('3928637', 19.814056731825964),
                       ('3917230', 6.300572539115049), ('3940627', 9.134252658117784), ('3922502', 12.274360288420825),
                       ('3988011', 6.848972072914495), ('3937690', 7.54934646018161), ('3973838', 8.286328619907088),
                       ('3905478', 7.284828043571285), ('3905801', 9.706629964513258), ('3950909', 6.873998162437278),
                       ('3974805', 21.076457895268714), ('3917015', 8.977243752790585), ('3988822', 11.726927711704263),
                       ('3985507', 9.201799067764215), ('3987743', 19.598454948714185), ('3967563', 9.521490731463278),
                       ('3945048', 14.387767106292252), ('3901430', 6.070774500986292), ('3977458', 9.107039858545884),
                       ('3934283', 20.2124582053489), ('3959815', 7.6181207561556485), ('3998084', 32.409782157740516),
                       ('3929083', 8.939621954252289), ('3990119', 14.017508000225382), ('3933691', 5.970241403452369),
                       ('3913277', 11.82921896308876), ('3964490', 14.150314042305936), ('3949329', 6.760859155539418),
                       ('3926643', 8.634816488129191), ('3930945', 8.59705431206792), ('3908448', 10.264639745015812),
                       ('3925906', 7.75579356373589), ('3972779', 9.32244157336273), ('3950861', 10.754212614706432),
                       ('3931737', 9.222753296308216), ('3941252', 7.735427828345503), ('3994934', 22.72189889456273),
                       ('3967928', 16.177299441184516), ('3925201', 16.44737769561971), ('3985242', 9.340959447570922),
                       ('3982260', 11.220355049252463), ('3905467', 12.276954179210778), ('3928867', 6.162110928218908),
                       ('3921070', 15.097493153040057), ('3979683', 9.506702927630037), ('3983906', 8.18922375907066),
                       ('3917945', 16.347273584516593), ('3989690', 10.149589501883295),
                       ('3971330', 15.335071544529498), ('3925654', 12.941178985642969),
                       ('3946984', 15.444391187717086), ('3949672', 17.304502073774923), ('3949184', 9.503742624092148),
                       ('3972186', 19.167009115904133), ('3997564', 9.537598311068791), ('3922999', 8.004944821898093),
                       ('3934232', 7.73216698364317), ('3954762', 11.65318194735813), ('3931987', 13.379983067088768),
                       ('3921764', 8.60990987538391), ('3962607', 7.982562726349705), ('3954660', 17.95525078254847),
                       ('3902614', 12.19098032246893), ('3984186', 23.605614640623408), ('3914323', 7.849362122161322),
                       ('3946959', 7.607871915870786), ('3984620', 16.616499383786607), ('3970931', 13.162068848669382),
                       ('3969723', 11.30782251461267), ('3915925', 5.994221484552912), ('3927382', 8.98377185784748),
                       ('3948062', 9.585457575489198), ('3918509', 11.982741475057786), ('3970876', 8.200541377791133),
                       ('3904726', 10.673392047413557), ('3988177', 9.0732066775653), ('3962645', 8.342333867735642),
                       ('3932701', 7.716812375011108), ('3909664', 17.861731976774927), ('3919928', 9.338527609989725),
                       ('3936949', 11.569419083972988), ('3912829', 19.217655822814006),
                       ('3958231', 21.995907349057767)])
mae_dias_best_list = np.array([('3990324', 17.914147754108917), ('3994483', 6.461204650884582), ('3974901', 8.849586321461757),
                      ('3910837', 8.774596588298442), ('3970494', 5.162145591655893), ('3981733', 7.204472694700602),
                      ('3950660', 8.85570187467214), ('3946200', 5.618391813747549), ('3954524', 9.067105096369703),
                      ('3935563', 6.674015274826607), ('3906864', 7.45332346365876), ('3902729', 5.452139788888477),
                      ('3957783', 12.580322273920817), ('3960685', 3.281140008888312), ('3983328', 6.770717231871057),
                      ('3964898', 12.287395995713508), ('3926797', 12.027046811959925), ('3941267', 7.598210346367495),
                      ('3967454', 5.950578860725515), ('3979586', 7.452362678010823), ('3911428', 11.948577106409111),
                      ('3952492', 12.36919089039845), ('3909677', 17.1779416535196), ('3939481', 10.041276503543605),
                      ('3950441', 9.900124621768567), ('3999053', 12.545243528751568), ('3986511', 13.622937292876465),
                      ('3977577', 9.054192096676285), ('3964440', 12.194514450575555), ('3944344', 6.2665616250724625),
                      ('3924240', 13.738361695906857), ('3933328', 8.950419791868569), ('3902894', 7.121029938749582),
                      ('3956739', 11.184357561150186), ('3983584', 5.293134229261629), ('3977192', 8.69037323054822),
                      ('3960109', 30.08688166529718), ('3928637', 23.120307423590518), ('3917230', 6.616777269689468),
                      ('3940627', 7.170806293865479), ('3922502', 10.583061520367202), ('3988011', 4.422589996488168),
                      ('3937690', 6.698769521182753), ('3973838', 7.611304631032921), ('3905478', 5.459178716506685),
                      ('3905801', 7.389051861917104), ('3950909', 7.749423171408297), ('3974805', 17.6471165358282),
                      ('3917015', 7.950964004202806), ('3988822', 10.3617426495823), ('3985507', 9.603917524805606),
                      ('3987743', 16.747273150487022), ('3967563', 8.580744869532136), ('3945048', 10.211581935850441),
                      ('3901430', 6.8754726360481335), ('3977458', 9.32288047387246), ('3934283', 18.318399864054648),
                      ('3959815', 7.782808671941898), ('3998084', 33.79220317253115), ('3929083', 7.043453121832565),
                      ('3990119', 9.843532928684125), ('3933691', 5.509299042561149), ('3913277', 11.729626057642408),
                      ('3964490', 12.554617264863259), ('3949329', 6.293525818337658), ('3926643', 6.953346330331242),
                      ('3930945', 9.038346892567672), ('3908448', 11.418201065233495), ('3925906', 8.591951313323916),
                      ('3972779', 9.140064946722323), ('3950861', 10.000458315330867), ('3931737', 14.273448498173481),
                      ('3941252', 6.446987430977131), ('3994934', 20.77283178281479), ('3967928', 14.760835360166215),
                      ('3925201', 15.462617197925896), ('3985242', 7.855350994926375), ('3982260', 9.139463489940631),
                      ('3905467', 10.948448468159265), ('3928867', 7.263254430726943), ('3921070', 13.404739222805022),
                      ('3979683', 7.954998855609682), ('3983906', 7.7497067661602905), ('3917945', 16.364838526154827),
                      ('3989690', 6.311054432930022), ('3971330', 14.957467962329018), ('3925654', 13.427203476274986),
                      ('3946984', 15.379257157736673), ('3949672', 19.525373044616543), ('3949184', 12.38328459202359),
                      ('3972186', 20.44634559165091), ('3997564', 9.821465035456278), ('3922999', 6.673161376805257),
                      ('3934232', 6.958867430563497), ('3954762', 11.153669739794685), ('3931987', 11.77747845098789),
                      ('3921764', 6.70544978798231), ('3962607', 8.092168112507176), ('3954660', 21.78954774847148),
                      ('3902614', 10.289657139143472), ('3984186', 24.63587713247587), ('3914323', 7.754502618148155),
                      ('3946959', 7.001251428274104), ('3984620', 16.639206061256505), ('3970931', 11.708396831260234),
                      ('3969723', 11.681830197423457), ('3915925', 5.7789160436030045), ('3927382', 10.426073554172838),
                      ('3948062', 9.122746808919334), ('3918509', 10.938691647891545), ('3970876', 6.995526644067787),
                      ('3904726', 10.841762227923148), ('3988177', 8.754612675874478), ('3962645', 5.672113458147228),
                      ('3932701', 7.505492755162228), ('3909664', 18.089319029992936), ('3919928', 9.362846909455298),
                      ('3936949', 16.149332836048135), ('3912829', 18.57782747248833), ('3958231', 19.42225602933298)])
mae_sys_final_list = np.array([('3990324', 38.23359232333746), ('3994483', 12.89186726975722), ('3974901', 16.29377651671688),
                      ('3910837', 15.793830524341026), ('3970494', 25.95445220824063), ('3981733', 18.291215701689552),
                      ('3950660', 14.304415077126253), ('3946200', 28.069232571211185), ('3954524', 18.80971245386101),
                      ('3935563', 11.513202583778497), ('3906864', 14.6452355754085), ('3902729', 10.003533687493114),
                      ('3957783', 15.449480703948964), ('3960685', 8.733844749638624), ('3983328', 10.153021497758575),
                      ('3964898', 17.066889676581003), ('3926797', 22.831534807304013), ('3941267', 16.954137054409006),
                      ('3967454', 16.14300986333793), ('3979586', 16.74446125332349), ('3911428', 15.099032945596065),
                      ('3952492', 15.652185827856337), ('3909677', 17.982763552776444), ('3939481', 17.723671348297135),
                      ('3950441', 17.28485442993652), ('3999053', 19.41824792101949), ('3986511', 17.937206067793436),
                      ('3977577', 19.977764311857793), ('3964440', 14.347177266927071), ('3944344', 13.329563249333743),
                      ('3924240', 11.929522743230839), ('3933328', 19.887367847661757), ('3902894', 13.261686803952983),
                      ('3956739', 15.173901226603848), ('3983584', 20.565779473622502), ('3977192', 14.452716283320122),
                      ('3960109', 43.624298551640585), ('3928637', 22.530210936761193), ('3917230', 17.112850380423016),
                      ('3940627', 34.29337730261745), ('3922502', 16.805819483255338), ('3988011', 22.959810690795724),
                      ('3937690', 15.331145367477186), ('3973838', 27.068784064898107), ('3905478', 9.649744121537136),
                      ('3905801', 25.37741705204048), ('3950909', 14.059387932430806), ('3974805', 20.968211381562366),
                      ('3917015', 13.880093768018131), ('3988822', 11.236665413959003), ('3985507', 15.287403362378523),
                      ('3987743', 14.87360196177704), ('3967563', 18.210682829177564), ('3945048', 54.715565869888344),
                      ('3901430', 20.191928938045233), ('3977458', 21.59745224373142), ('3934283', 42.52206610740736),
                      ('3959815', 25.228347753367146), ('3998084', 44.67311598971132), ('3929083', 13.063572372501833),
                      ('3990119', 32.50346500306056), ('3933691', 13.170954873813905), ('3913277', 12.52026381735652),
                      ('3964490', 13.603401235141629), ('3949329', 15.17333564639617), ('3926643', 10.390574722637469),
                      ('3930945', 25.054408137185586), ('3908448', 17.961427707481743), ('3925906', 18.95931134623522),
                      ('3972779', 27.78320817370567), ('3950861', 19.362696029267223), ('3931737', 8.94325011660568),
                      ('3941252', 13.566159613816874), ('3994934', 14.12040805492114), ('3967928', 36.09495489385367),
                      ('3925201', 19.994859781952727), ('3985242', 16.05169605156941), ('3982260', 30.875604972023428),
                      ('3905467', 15.239111699268312), ('3928867', 18.14705694498315), ('3921070', 20.4075103767657),
                      ('3979683', 17.346166281277476), ('3983906', 16.46828590313674), ('3917945', 14.07378598284093),
                      ('3989690', 17.760818660462583), ('3971330', 36.82953835394377), ('3925654', 33.45602707288842),
                      ('3946984', 27.735442479753623), ('3949672', 17.72055358389267), ('3949184', 17.988494019809814),
                      ('3972186', 15.783817310484862), ('3997564', 19.6755940350047), ('3922999', 8.927683678744957),
                      ('3934232', 13.496236880594381), ('3954762', 21.62947042808206), ('3931987', 15.726802352927365),
                      ('3921764', 21.02687194659482), ('3962607', 21.609994168140066), ('3954660', 29.29318870106218),
                      ('3902614', 18.044451381774156), ('3984186', 42.11942180088517), ('3914323', 11.864262018435618),
                      ('3946959', 17.940788734980718), ('3984620', 15.38436262486302), ('3970931', 13.241811572651875),
                      ('3969723', 24.225347761027034), ('3915925', 23.85060766686785), ('3927382', 15.195816819236246),
                      ('3948062', 17.660235853196987), ('3918509', 15.752238328315372), ('3970876', 27.0426630735276),
                      ('3904726', 14.88167954906032), ('3988177', 21.365059873065828), ('3962645', 16.349128212419785),
                      ('3932701', 20.12494220083678), ('3909664', 17.020425805306395), ('3919928', 13.847932962574834),
                      ('3936949', 21.393194960521402), ('3912829', 26.786333678816156), ('3958231', 60.07181323684883)])
mae_sys_best_list = np.array([('3990324', 35.224694600235274), ('3994483', 14.168975712903553), ('3974901', 11.761151636471483),
                     ('3910837', 17.656081608870057), ('3970494', 31.492313148756935), ('3981733', 11.546647657978761),
                     ('3950660', 9.737460513264606), ('3946200', 27.473427636206836), ('3954524', 15.543794816617455),
                     ('3935563', 9.22954427167195), ('3906864', 13.75544950640684), ('3902729', 8.446995799537321),
                     ('3957783', 11.115905402747826), ('3960685', 5.641174988284841), ('3983328', 11.547939729771153),
                     ('3964898', 13.42113491274566), ('3926797', 16.961551770356838), ('3941267', 16.48890774449077),
                     ('3967454', 15.178868756667077), ('3979586', 18.014965741636896), ('3911428', 16.926183954101884),
                     ('3952492', 15.0461457929003), ('3909677', 14.784252382621384), ('3939481', 15.900280944502327),
                     ('3950441', 16.035042459504105), ('3999053', 23.52882930042401), ('3986511', 20.974459608697636),
                     ('3977577', 15.409204657342677), ('3964440', 13.116078211788968), ('3944344', 11.103735211664063),
                     ('3924240', 9.505582247409533), ('3933328', 16.570859321763685), ('3902894', 10.079763150669386),
                     ('3956739', 15.534056474943988), ('3983584', 21.03096914953674), ('3977192', 11.184437615339583),
                     ('3960109', 41.96682425774542), ('3928637', 18.32589073929349), ('3917230', 14.108312162707982),
                     ('3940627', 29.839981814837103), ('3922502', 15.811866516558583), ('3988011', 16.225401496987892),
                     ('3937690', 14.564963764599383), ('3973838', 22.58620570578562), ('3905478', 7.492960600585488),
                     ('3905801', 25.859108059232764), ('3950909', 13.155229539778114), ('3974805', 21.79335906373),
                     ('3917015', 14.403751244083967), ('3988822', 12.74452862239248), ('3985507', 17.18576702788875),
                     ('3987743', 10.443815071772004), ('3967563', 15.357821648896886), ('3945048', 45.20517808829371),
                     ('3901430', 12.782297777605407), ('3977458', 15.482148627595647), ('3934283', 36.09183548723758),
                     ('3959815', 20.693712822856494), ('3998084', 42.18955708875104), ('3929083', 12.834456089628029),
                     ('3990119', 37.478226659644456), ('3933691', 10.08470112360346), ('3913277', 10.675405361288114),
                     ('3964490', 12.73767262629451), ('3949329', 14.872958463550205), ('3926643', 9.528380527420111),
                     ('3930945', 20.78216687589388), ('3908448', 16.480073132153386), ('3925906', 19.90904221909399),
                     ('3972779', 31.831559431051293), ('3950861', 17.492882508680626), ('3931737', 8.32177323591481),
                     ('3941252', 11.220431911600391), ('3994934', 15.83510467662742), ('3967928', 29.357101017870004),
                     ('3925201', 21.083895279023356), ('3985242', 11.260665847651554), ('3982260', 33.19813327972083),
                     ('3905467', 13.173594865863151), ('3928867', 18.247971307716842), ('3921070', 19.79672650180081),
                     ('3979683', 15.809348820176993), ('3983906', 13.066415101390666), ('3917945', 12.022435632553426),
                     ('3989690', 12.346985580495108), ('3971330', 33.03743557291153), ('3925654', 32.496171304452325),
                     ('3946984', 31.307939215441493), ('3949672', 10.854920538907482), ('3949184', 12.216152662449943),
                     ('3972186', 18.509149556907634), ('3997564', 13.454645644287126), ('3922999', 6.9083854564908425),
                     ('3934232', 10.412369433415387), ('3954762', 15.883719565811866), ('3931987', 14.722524692686667),
                     ('3921764', 18.69587892606961), ('3962607', 19.73485958966772), ('3954660', 36.11489948505116),
                     ('3902614', 9.939570750752772), ('3984186', 53.18573872765187), ('3914323', 11.044149747253828),
                     ('3946959', 20.007496440438768), ('3984620', 21.238465882522352), ('3970931', 10.365217185854164),
                     ('3969723', 25.563618463404804), ('3915925', 20.291621718219037), ('3927382', 13.340850883483501),
                     ('3948062', 14.218163777097084), ('3918509', 12.945929420687795), ('3970876', 27.017983736874058),
                     ('3904726', 16.071218518219485), ('3988177', 21.851913795087967), ('3962645', 15.273313603762142),
                     ('3932701', 11.134322470987938), ('3909664', 15.739241943321948), ('3919928', 11.08017522962174),
                     ('3936949', 15.668222479972796), ('3912829', 28.520578956727597), ('3958231', 53.988872590175674)])

dias_results = [mae_dias_final_list, mae_dias_best_list]
sys_results = [mae_sys_final_list, mae_sys_best_list]

best_patients = []
for list in dias_results:
    dict_results = dict((x, float(y)) for x, y in list)
    best_dict = {k: v for k, v in dict_results.items() if v < 12}
    print(f"Num best: {len(best_dict)}")
    print(f"Best patients: {best_dict.keys()}")
    best_patients.append(best_dict.keys())

for list in sys_results:
    dict_results = dict((x, float(y)) for x, y in list)
    best_dict = {k: v for k, v in dict_results.items() if v < 20}
    print(f"Num best: {len(best_dict)}")
    print(f"Best patients: {best_dict.keys()}")
    best_patients.append(best_dict.keys())

dias_intersection = best_patients[0] & best_patients[1]
print(f"dias intersection: {dias_intersection}")
print(f"num_patients: {len(dias_intersection)}")

sys_intersection = best_patients[2] & best_patients[3]
print(f"sys intersection: {sys_intersection}")
print(f"num_patients: {len(sys_intersection)}")

final_intersaction = best_patients[0] & best_patients[2]
print(f"sys intersection: {final_intersaction}")
print(f"num_patients: {len(final_intersaction)}")

best_intersaction = best_patients[1] & best_patients[3]
print(f"final intersection: {best_intersaction}")
print(f"num_patients: {len(best_intersaction)}")

good_patients = dias_intersection | sys_intersection
print(f"best intersection: {good_patients}")
print(f"num_patients: {len(good_patients)}")

for patient in best_intersaction:
    source_folder = f"{Config.DATASET_DIR_UN_COMPRESSED}/Test/{patient}"
    destination_folder = f"{Config.DATASET_DIR_UN_COMPRESSED}/Good Test Patients/{patient}"

    # move only files
    if os.path.isdir(source_folder):
        shutil.move(source_folder, destination_folder)
        print('Moved:', source_folder)


